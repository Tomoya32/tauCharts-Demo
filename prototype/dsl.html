<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.js"></script>

    <!-- src -->
    <script src="../src/class.js"></script>
    <script src="../src/tau.data.js"></script>
    <script src="../src/tau.data.types.js"></script>
    <script src="../src/tau.svg.js"></script>
    <script src="../src/tau.charts.js"></script>
    <script src="../src/charts/line.js"></script>
    <script src="../src/charts/scatterplot.js"></script>
    <script src="../src/charts/bar.js"></script>
    <script src="../src/tau.plugins.js"></script>

    <!-- plugins -->
    <script src="../plugins/tooltip.js"></script>
    <script src="../plugins/legend.js"></script>
    <script src="../plugins/highlighter.js"></script>
    <script src="../plugins/projection.js"></script>
    <script src="../plugins/datatable.js"></script>
    <script src="../plugins/header.js"></script>
    <script src="../plugins/trend.js"></script>
    <script src="../plugins/jittering.js"></script>

    <!-- test data -->
    <script src="data.js"></script>

    <script src="countries.js"></script>
    <script src="tpStories.js"></script>
    <script src="dataTp.js"></script>
    <script src="../build/tauCharts.js"></script>
    <!-- css -->
    <link href="../css/default.css" rel="stylesheet"/>
    <link href="../css/oldschool.css" rel="stylesheet"/>
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600&subset=latin,cyrillic-ext' rel='stylesheet' type='text/css">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700&subset=latin,cyrillic-ext' rel='stylesheet'
          type='text/css'>
    <style>
        .axes.nest .axis.nest text {
            font-size: 10px;
        }
        .bar {
            fill: steelblue;
        }
        .cc {
            display:inline-block;
            margin:2px 2px 2px 2px;
            float:left;
            width: 800px;
            height: 800px;
        }
    </style>
</head>
<body>

<div id="chart-container" class="cc"></div>

<div id="simple-container" class="cc"></div>

<div id="complex-container" class="cc"></div>

<div id="bars-container" class="cc"></div>

<script>

    var def = {
        dimensions: {
            project: { scaleType: 'ordinal' },
            team: { scaleType: 'ordinal' },
            cycleTime: { scaleType: 'linear' },
            effort: { scaleType: 'linear' }
        },
        unit: {
            type: 'COORDS.RECT',
            guide: {
                padding: { L:120, B:24, R:0, T:0 }
            },
            x: {scaleDim: 'project', label: '<h4>Projects</h4>'},
            y: {scaleDim: 'team', label: '<h4>Teams</h4>'},
            unit: [
                {
                    type: 'COORDS.RECT',
                    guide: {
                        showGridLines: 'xy',
                        padding: { L:32, B:32, R:8, T:8 },
                        x: {padding: 8, label: 'cycle time'},
                        y: {padding: 8, label: 'effort'}
                    },
                    x: 'cycleTime',
                    y: 'effort',
                    unit: [
                        {
                            type: 'ELEMENT.POINT',
                            x: 'cycleTime',
                            y: 'effort',
                            color: 'effort',
                            size: 'cycleTime',
                            shape: null
                        }
                    ]
                }
            ]
        }
    };

    var scatter = {
        dimensions: {
            project: { scaleType: 'ordinal' },
            team: { scaleType: 'ordinal' },
            cycleTime: { scaleType: 'linear' },
            effort: { scaleType: 'linear' }
        },
        unit: {
            type: 'COORDS.RECT',
            guide: {
                showGridLines: 'xy',
                padding: { L:36, B:36, R:8, T:8 }
            },
            x: {scaleDim: 'cycleTime', padding: 8},
            y: {scaleDim: 'effort', padding: 8},
            unit: [
                {
                    type: 'ELEMENT.POINT',
                    x: 'cycleTime',
                    y: 'effort',
                    color: 'effort',
                    size: 'cycleTime',
                    shape: null
                }
            ]
        }
    };

    var complex_scatter = {
        dimensions: {
            project: { scaleType: 'ordinal' },
            team: { scaleType: 'ordinal' },
            cycleTime: { scaleType: 'linear' },
            effort: { scaleType: 'linear' }
        },
        unit: {
            type: 'COORDS.RECT',
            guide: {
                padding: { L:36, B:2, R:0, T:2 }
            },
            x: null,
            y: {scaleDim: 'project', label: '<h4>Projects</h4>'},
            unit: [
                {
                    type: 'COORDS.RECT',
                    guide: {
                        padding: { L:120, B:4, R:8, T:4 }
                    },
                    x: null,
                    y: {scaleDim: 'team', label: '<h4>Teams</h4>'},
                    unit: [
                        {
                            type: 'COORDS.RECT',
                            guide: {
                                showGridLines: 'xy',
                                padding: { L:36, B:20, R:8, T:4 }
                            },
                            x: {scaleDim: 'cycleTime', label: '<h4>cycle time</h4>', padding: 4},
                            y: {scaleDim: 'effort', label: '<h4>effort</h4>', padding: 4},
                            unit: [
                                {
                                    type: 'ELEMENT.POINT',
                                    x: 'cycleTime',
                                    y: 'effort',
                                    color: 'effort',
                                    size: 'cycleTime',
                                    shape: null
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    };

    var rawData = _.map(
            getUserStories(),
            function (r) {
                r.cycleTime = r.name.length;
                return r;
            });

    new tauChart.Chart({
        data: rawData,
        spec: def,
        plugins: [tau.plugins.tooltip('team', 'project', 'cycleTime', 'effort'), tau.plugins.highlighter()]
    }).renderTo('#chart-container', {width: 800, height: 800});

    var scatterChart = new tauChart.Chart({
        data: rawData,
        spec: scatter,
        plugins: [tau.plugins.tooltip('team', 'project', 'cycleTime', 'effort'), tau.plugins.highlighter()]
    }).renderTo('#simple-container', {width: 800, height: 800});

    var complexChart = new tauChart.Chart({
        data: rawData,
        spec: complex_scatter,
        plugins: [tau.plugins.tooltip('team', 'project', 'cycleTime', 'effort'), tau.plugins.highlighter()]
    }).renderTo('#complex-container', {width: 800, height: 800});

    getCountOfEntitiesByTeamOnMonth().then(function (data) {

        var def = {
            dimensions: {
                month: { scaleType: 'ordinal' },
                project: { scaleType: 'ordinal' },
                team: { scaleType: 'ordinal' },
                cycleTime: { scaleType: 'linear' },
                effort: { scaleType: 'linear' },
                count: { scaleType: 'linear' }
            },
            unit: {
                type: 'COORDS.RECT',
                guide: {
                    padding: { L:80, B:8, R:8, T:8 }
                },
                x: null,
                y: 'team',
                unit: [
                    {
                        type: 'COORDS.RECT',
                        guide: {
                            padding: { L:36, B:24, R:8, T:8 },
                            showGridLines: 'xy'
                        },
                        x: {scaleDim: 'month', label: '<h4>effort</h4>'},
                        y: {scaleDim: 'count', label: '<h4>cycle time</h4>'},
                        unit: [
                            {
                                type: 'ELEMENT.POINT',
                                x: 'month',
                                y: 'count',
                                color: null,
                                size: null,
                                shape: null
                            },
                            {
                                type: 'ELEMENT.INTERVAL',
                                x: 'month',
                                y: 'count',
                                color: null,
                                size: null,
                                shape: null
                            },
                            {
                                type: 'ELEMENT.LINE',
                                x: 'month',
                                y: 'count',
                                color: null,
                                size: null,
                                shape: null
                            }
                        ]
                    }
                ]
            }
        };

        new tauChart.Chart({data: data, spec: def, plugins: [tau.plugins.tooltip('team', 'count', 'month'), tau.plugins.highlighter()]})
                .renderTo('#complex-container', {width: 800, height: 800});
    });

</script>
</body>
</html>
